<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Titolo del post del blog">
    <title>Breaking Caesar's Cypher</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: "Helvetica", Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #fafafa;
            color: #333;
        }

        header {
            background-color: #222;
            color: white;
            padding: 1.5rem 0;
            text-align: center;
        }

        main {
            max-width: 800px;
            margin: 2rem auto;
            background: white;
            padding: 2rem;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            border-radius: 10px;
        }

        article h1 {
            color: #111;
            margin-bottom: 0.5rem;
        }

        .post-meta {
            color: #777;
            font-size: 0.9rem;
            margin-bottom: 2rem;
        }

        article img {
            width: 100%;
            border-radius: 10px;
            margin: 1rem 0;
        }

        footer {
            text-align: center;
            padding: 1rem;
            background-color: #222;
            color: white;
            font-size: 0.9rem;
        }

        .riquadro-testo {
      width: 400px;
      padding: 20px;
      margin: 40px auto;
      background-color: #f8f9fa;
      border: 2px solid #ccc;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      font-family: Arial, sans-serif;
      font-size: 16px;
      color: #333;
      line-height: 1.5;
      overflow-y: auto; /* permette lo scroll se il testo è lungo */
      max-height: 200px; /* limita l'altezza */
    }
    </style>
</head>
<body>

    <header>
        <h1>Homework 2</h1>
    </header>

<main>

    <article>
        <h1>Breaking Caesar's Cypher</h1>
        <div class="post-meta">
            <span>Posted on October 12, 2025 by Andrea Buratti</span>
        </div>
        <p>Caesar's cypher is a simple substitution cipher where each letter in the plaintext is shifted a certain number of places down or up the alphabet. For example, with a shift of 3, 'A' would be replaced by 'D', 'B' would become 'E', and so on.</p>
        <p>To break Caesar's cypher, one common method is to use frequency analysis. This involves analyzing the frequency of letters in the encrypted text and comparing it to the known frequency of letters in the language of the plaintext. In English, for example, 'E' is the most common letter, followed by 'T', 'A', 'O', 'I', and 'N'. By identifying the most frequent letters in the ciphertext, we can make educated guesses about which letters they correspond to in the plaintext.</p>
        <p>Another approach is to try all possible shifts (there are only 25 possible shifts in a standard alphabet) and see which one produces a readable message. This brute-force method is feasible due to the limited number of possibilities.</p>
        <p>Once we have identified a potential shift, we can decode the entire message and check if it makes sense. If it does, we have successfully broken the cypher!</p>
    
        <h2>The Procedure</h2>
                <p>To implement the breaking of Caesar's cypher, we can follow these steps:</p>

                <ol>
                    <li>Count the frequency of each letter in the ciphertext.</li>
                    <li>Identify the most frequent letters and make educated guesses about their plaintext equivalents.</li>
                    <li>Try all possible shifts and decode the message for each shift.</li>
                    <li>Check the decoded messages for readability and coherence.</li>

                </ol>

                <h3> The first step</h3>
                <p> We first need to take a text and encrypt it, then we will try to break the cypher.</p>
                <div class="riquadro-testo">
                    <p>Alice was beginning to get very tired of sitting by her sister on the bank, and of having nothing to do: once or twice she had peeped into the book her sister was reading, but it had no pictures or conversations in it, “and what is the use of a book,” thought Alice “without pictures or conversations?”

So she was considering in her own mind (as well as she could, for the hot day made her feel very sleepy and stupid), whether the pleasure of making a daisy-chain would be worth the trouble of getting up and picking the daisies, when suddenly a White Rabbit with pink eyes ran close by her.

There was nothing so very remarkable in that; nor did Alice think it so very much out of the way to hear the Rabbit say to itself, “Oh dear! Oh dear! I shall be late!” (when she thought it over afterwards, it occurred to her that she ought to have wondered at this, but at the time it all seemed quite natural); but when the Rabbit actually took a watch out of its waistcoat-pocket, and looked at it, and then hurried on, Alice started to her feet, for it flashed across her mind that she had never before seen a rabbit with either a waistcoat-pocket, or a watch to take out of it, and burning with curiosity, she ran across the field after it, and fortunately was just in time to see it pop down a large rabbit-hole under the hedge.

In another moment down went Alice after it, never once considering how in the world she was to get out again.</p>
                </div>

                <p> Of course, punctuation and spaces are not encrypted, so they remain the same in the cyphertext. Maybe there can be some sort of exploit
                regarding them, but that's not the point, i really like Alice in Wonderland so let me use it!</p>

                <h3> The second step</h3>
                <p> 
                    Now we need to encrypt the text, for that we need a key, which is just a number between 1 and 25, representing the shift. Clicking on the "generate key" button should
                    do the work, and you will see the text getting encrypted right away
                </p>

                <button onclick="generateKey(),analizzaTesto()">Generate Key</button>

                <p> Now that we encrypted the text, we will try to break it. Again, the rule is that, even when shifting letters, their count won't change. We can guess how much the shift was
                    by simply counting! </p>

                <h3> The third step</h3>
                <p>
                    Counting the letters is not that big of a task, and the results are listed below:
                </p>
                <div>
                <canvas id="graficoFrequenza" width="400" height="200"></canvas>
                </div>

                <p> As you can see, the most frequent letter is 'e', which is also the most frequent letter in the English language. Guessing the shift is now easy.
                    There are various ways to do it, my choice is simply to subtract the ascii code of 'e' from the ascii code of the most frequent letter, and then take modulo 26.
                </p>
                <button onclick="alert('The guessed key is: ' + guessKey() + '\nThe actual key is: ' + key)">Guess the Key</button>














    </article>




</main>

    <footer>
        <p>&copy; 2025 Il Mio Blog — Tutti i diritti riservati.</p>
    </footer>   

    <script>

        let grafico;

        window.onload = function() {
            analizzaTesto();
        };

        let key = 0;
        let testo = "";


        function analizzaTesto()
        {
            const testo = window.document.getElementsByClassName("riquadro-testo")[0].innerText;
            const frequenza = {};
            let totaleLettere = 0;
            for (let i = 0; i < testo.length; i++) {
                const char = testo[i].toLowerCase();
                if (char >= 'a' && char <= 'z') { // considera solo lettere
                    frequenza[char] = (frequenza[char] || 0) + 1;
                    totaleLettere++;
                }
            }

            const lettere = Object.keys(frequenza).sort();
            const percentuali = lettere.map(lettera => ((frequenza[lettera] / totaleLettere) * 100).toFixed(2));
            const ctx = document.getElementById('graficoFrequenza').getContext('2d');
            if(grafico) grafico.destroy();

            grafico = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: lettere,
                    datasets: [{
                        label: 'Frequenza (%)',
                        data: percentuali,
                        backgroundColor: 'rgba(54, 162, 235, 0.6)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

        }



        function generateKey()
        {
            key = Math.floor(Math.random() * 25) + 1; // genera un numero tra 1 e 25
            encryptText(key);

        }
        
        function encryptText(key)
        {
            testo = window.document.getElementsByClassName("riquadro-testo")[0].innerText;
            let encryptedText = "";
            for(let i = 0; i < testo.length; i++)
            {
                let char = testo[i];
                if(char >= 'a' && char <= 'z')
                {
                    let shiftedCharCode = ((char.charCodeAt(0) - 'a'.charCodeAt(0) + key) % 26) + 'a'.charCodeAt(0);
                    encryptedText += String.fromCharCode(shiftedCharCode);
                }
                else if(char >= 'A' && char <= 'Z')
                {
                    let shiftedCharCode = ((char.charCodeAt(0) - 'A'.charCodeAt(0) + key) % 26) + 'A'.charCodeAt(0);
                    encryptedText += String.fromCharCode(shiftedCharCode);
                }
                else
                {
                    encryptedText += char; // non cambia
                }
            }
            window.document.getElementsByClassName("riquadro-testo")[0].innerText = encryptedText;
        }

        function guessKey()
        {
            // 'e' is the most frequent char in english
            console.log("grafico data", grafico.data);
            console.log("grafico data datasets 0 data", grafico.data.datasets[0].data);
            console.log("grafico data labels", grafico.data.labels);
            const labels = grafico.data.labels;
            const values = grafico.data.datasets[0].data;
            const maxIndex = values.indexOf(Math.max(...values));
            const mostFrequentChar = labels[maxIndex];
            const assumedPlaintextChar = 'e';
            let guessedKey = (mostFrequentChar.charCodeAt(0) - assumedPlaintextChar.charCodeAt(0) + 26) % 26;
            if(guessedKey === 0) guessedKey = 26; // to avoid 0 key
            console.log("Guessed key:", guessedKey);
            console.log("actual key:", key);
            return guessedKey;
        }


    </script>

</body>
</html>

